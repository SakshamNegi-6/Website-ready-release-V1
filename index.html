<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cyber Security Quiz</title>
  <meta name="description" content="An interactive and educational Cyber Security Quiz." />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Orbitron:wght@700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: #2a2a2a;
      color: white;
    }
    h1, h2, h3 {
      text-align: center;
      color: #ffffff;
    }

    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background-color: #333;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    }

    .main-btn, .secondary-btn {
      background-color: #41e0c3;
      border: none;
      color: white;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 5px;
      margin-top: 10px;
    }

    .option-btn {
      background-color: #555;
      border: none;
      color: white;
      padding: 10px;
      margin: 5px;
      width: 100%;
      cursor: pointer;
      border-radius: 5px;
    }

    .option-btn:hover {
      background-color: #666;
    }

    .hidden {
      display: none;
    }

    .question {
      font-size: 1.5em;
      margin-bottom: 20px;
    }

    .feedback {
      font-size: 1.2em;
      margin-top: 20px;
    }

    #progress-bar {
      height: 10px;
      background-color: #41e0c3;
      width: 0;
      border-radius: 5px;
    }

    #streak-counter {
      font-size: 1.2em;
      margin-top: 20px;
    }

    #modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
    }

    #modal-content {
      background-color: #333;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      width: 300px;
      color: white;
    }

    .settings-row {
      display: flex;
      justify-content: space-between;
      margin: 10px 0;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 28px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #333;
      transition: .4s;
      border-radius: 28px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 4px;
      bottom: 4px;
      background: #fff;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background: #41e0c3;
    }

    input:checked + .slider:before {
      transform: translateX(22px);
    }
  </style>
</head>
<body>
  <!-- Splash -->
  <div id="splash-screen">
    <h1>Cyber Security Quiz</h1>
  </div>

  <!-- Welcome -->
  <div id="welcome-container" class="container">
    <h1>Cyber Security Quiz</h1>
    <h2>A Fun Cyber Safety Challenge for Families</h2>
    <button id="start-btn" class="main-btn">Start Quiz</button>
    <div class="welcome-options">
      <button id="settings-btn">‚öôÔ∏è Settings</button>
      <button id="about-btn">‚ÑπÔ∏è About</button>
    </div>
  </div>

  <!-- Quiz container -->
  <div id="quiz-container" class="container hidden">
    <div class="quiz-header">
      <span id="streak-counter"></span>
      <button id="hint-btn">üí° Hint</button>
    </div>
    <h3 id="round-title"></h3>
    <div id="progress-bar-container"><div id="progress-bar"></div></div>
    <div id="question-area">
      <p class="question" id="question"></p>
      <div class="options" id="options"></div>
      <div id="feedback-area" role="alert"></div>
    </div>
    <button id="next-btn" class="main-btn">Next</button>
  </div>

  <!-- Results -->
  <div id="results-container" class="container hidden">
    <div id="score-display-area"></div>
    <div id="high-score-area"></div>
    <div id="results-leaderboard-area" class="leaderboard"></div>
    <div id="save-score-area" class="hidden"></div>
    <div class="results-buttons">
      <button id="review-btn" class="main-btn">üîç Review Answers</button>
      <button id="go-home-btn" class="main-btn">üè† Go Home</button>
    </div>
    <div class="thank-you-message" id="thank-you-message"></div>
  </div>

  <!-- Settings Modal -->
  <div id="modal-overlay">
    <div id="modal-content" class="container">
      <h2>‚öôÔ∏è Settings</h2>
      <div class="settings-row"><label>Background Effects</label><label class="switch"><input type="checkbox" id="bg-toggle"><span class="slider"></span></label></div>
      <div class="settings-row"><label>High Contrast</label><label class="switch"><input type="checkbox" id="contrast-toggle"><span class="slider"></span></label></div>
      <div class="settings-row"><label>Large Text</label><label class="switch"><input type="checkbox" id="large-toggle"><span class="slider"></span></label></div>
      <div class="settings-row"><label>Reduce Motion</label><label class="switch"><input type="checkbox" id="motion-toggle"><span class="slider"></span></label></div>
      <div class="settings-row"><label>Theme</label><select id="theme-select"><option value="dark">Dark</option><option value="light">Light</option></select></div>
      <hr>
      <h3>Admin Controls</h3>
      <div class="settings-row"><button class="danger-btn" onclick="resetData('leaderboard')">Reset Leaderboard</button></div>
      <div class="settings-row"><button class="danger-btn" onclick="resetData('new-player')">Reset for New Player</button></div>
      <div class="settings-row"><button class="danger-btn" onclick="resetData('master')">Master Reset</button></div>
      <div class="modal-buttons"><button onclick="closeModal()" class="secondary-btn">Close</button></div>
    </div>
  </div>
<script>
  let currentQuestionIndex = 0;  // To track the current question

  // Separate hard mode and normal questions
  const hardModeQuestions = [
    { question:"What is a brute-force attack?", options:["Guessing every possible password combination","Installing random software","Sending spam emails","Hacking Wi-Fi"], answer:0 },
    { question:"What does 'SQL Injection' target?", options:["Databases through insecure queries","Antivirus software","CPU usage","RAM capacity"], answer:0 },
    { question:"A DDoS attack does what?", options:["Overloads a server with traffic","Deletes all files","Installs malware","Steals passwords directly"], answer:0 },
    { question:"What‚Äôs the purpose of hashing a password?", options:["Store it securely as non-reversible data","Encrypt temporarily","Hide it in RAM","Send it faster"], answer:0 },
    { question:"Which protocol uses port 443?", options:["HTTPS","HTTP","FTP","SMTP"], answer:0 },
    { question:"What‚Äôs an example of multi-factor authentication (MFA)?", options:["Password + Fingerprint","Username + Password","PIN + Password","Password + Birthday"], answer:0 }
  ];

  const normalQuestions = [
    { question:"A 'phishing' email is designed to...", options:["Trick you into revealing personal information","Sell you a product","Update your software","Entertain you"], answer:0 },
    { question:"What does 'HTTPS' at the start of a URL indicate?", options:["The website is popular","It is a high-speed site","The connection is secure and encrypted","The site is for commercial use"], answer:2 },
    { question:"Which of these is the strongest password?", options:["12345678","password123","R!v3r$1d3#24?","MyDogSparky"], answer:2 },
    { question:"What is the main risk of using public Wi-Fi?", options:["Slower internet speeds","Hackers can intercept your data","It uses more battery","You see more ads"], answer:1 },
    { question:"What should you do if you receive an unexpected email attachment?", options:["Open it immediately","Scan it with antivirus before opening","Forward it to friends","Ignore it always"], answer:1 },
    { question:"Which of the following is an example of two-factor authentication (2FA)?", options:["Entering a password only","Password + OTP sent to phone","Password + birthdate","Password + username"], answer:1 },
    { question:"A computer virus mainly...", options:["Physically damages the screen","Is malicious software that spreads","Increases computer speed","Improves internet"], answer:1 },
    { question:"Ransomware is a type of malware that...", options:["Asks for a ransom to restore your files","Deletes temporary files","Makes your computer faster","Updates your system"], answer:0 },
    { question:"Why should you update your software regularly?", options:["It looks better","To fix bugs and patch security holes","To get new wallpapers","Because it's fun"], answer:1 },
    { question:"What is a firewall?", options:["A security barrier that monitors traffic","A physical wall against fire","An antivirus program","A file storage system"], answer:0 }
  ];

  // Randomly select 20 questions (6-10 from hard mode, the rest from normal mode)
  function selectRandomQuestions() {
      // Shuffle the hard mode questions and pick 6-10 questions
      shuffleArray(hardModeQuestions);
      const selectedHardModeQuestions = hardModeQuestions.slice(0, 6 + Math.floor(Math.random() * 5));  // Randomly pick 6-10 hard mode questions

      // Shuffle the normal questions and pick the remaining questions to make a total of 20
      shuffleArray(normalQuestions);
      const selectedNormalQuestions = normalQuestions.slice(0, 20 - selectedHardModeQuestions.length);

      // Combine hard mode and normal questions
      const selectedQuestions = selectedHardModeQuestions.concat(selectedNormalQuestions);
      shuffleArray(selectedQuestions);  // Shuffle the final list of 20 questions
      return selectedQuestions;
  }

  // Shuffle array function
  function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]]; // Swap elements
      }
  }

  // Start quiz by selecting random questions
  const selectedQuestions = selectRandomQuestions();

  // Function to start the quiz
  function startQuiz() {
      // Hide the welcome screen
      document.getElementById('welcome-container').style.display = 'none';

      // Show the first question
      showQuestion(currentQuestionIndex);
  }

  // Function to display a question based on the current index
  function showQuestion(index) {
      const quizContainer = document.createElement('div');
      quizContainer.id = 'quiz-container';
      const question = selectedQuestions[index];

      quizContainer.innerHTML = `
          <h2>${question.question}</h2>
          ${question.options.map((option, i) => 
              `<button class="main-btn" onclick="nextQuestion(${i})">${option}</button>`
          ).join('')}
      `;
      document.body.appendChild(quizContainer);
  }

  // Function to move to the next question
  function nextQuestion(selectedOptionIndex) {
      alert("You selected: " + selectedQuestions[currentQuestionIndex].options[selectedOptionIndex]);

      // Remove the current question
      document.getElementById('quiz-container').remove();

      // Increment to show the next question
      currentQuestionIndex++;

      // Check if there are more questions
      if (currentQuestionIndex < selectedQuestions.length) {
          showQuestion(currentQuestionIndex);  // Show next question
      } else {
          alert("Quiz finished!");  // End of quiz
      }
  }
</script>
const questions = [
    { question:"A 'phishing' email is designed to...", options:["Trick you into revealing personal information","Sell you a product","Update your software","Entertain you"], answer:0 },
    { question:"What does 'HTTPS' at the start of a URL indicate?", options:["The website is popular","It is a high-speed site","The connection is secure and encrypted","The site is for commercial use"], answer:2 },
    { question:"Which of these is the strongest password?", options:["12345678","password123","R!v3r$1d3#24?","MyDogSparky"], answer:2 },
    { question:"What is the main risk of using public Wi-Fi?", options:["Slower internet speeds","Hackers can intercept your data","It uses more battery","You see more ads"], answer:1 },
    { question:"What should you do if you receive an unexpected email attachment?", options:["Open it immediately","Scan it with antivirus before opening","Forward it to friends","Ignore it always"], answer:1 },
    { question:"Which of the following is an example of two-factor authentication (2FA)?", options:["Entering a password only","Password + OTP sent to phone","Password + birthdate","Password + username"], answer:1 },
    { question:"A computer virus mainly...", options:["Physically damages the screen","Is malicious software that spreads","Increases computer speed","Improves internet"], answer:1 },
    { question:"Ransomware is a type of malware that...", options:["Asks for a ransom to restore your files","Deletes temporary files","Makes your computer faster","Updates your system"], answer:0 },
    { question:"Why should you update your software regularly?", options:["It looks better","To fix bugs and patch security holes","To get new wallpapers","Because it's fun"], answer:1 },
    { question:"What is a firewall?", options:["A security barrier that monitors traffic","A physical wall against fire","An antivirus program","A file storage system"], answer:0 },

    { question:"What is a brute-force attack?", options:["Guessing every possible password combination","Installing random software","Sending spam emails","Hacking Wi-Fi"], answer:0 },
    { question:"What does 'SQL Injection' target?", options:["Databases through insecure queries","Antivirus software","CPU usage","RAM capacity"], answer:0 },
    { question:"A DDoS attack does what?", options:["Overloads a server with traffic","Deletes all files","Installs malware","Steals passwords directly"], answer:0 },
    { question:"What‚Äôs the purpose of hashing a password?", options:["Store it securely as non-reversible data","Encrypt temporarily","Hide it in RAM","Send it faster"], answer:0 },
    { question:"Which protocol uses port 443?", options:["HTTPS","HTTP","FTP","SMTP"], answer:0 },
    { question:"What‚Äôs an example of multi-factor authentication (MFA)?", options:["Password + Fingerprint","Username + Password","PIN + Password","Password + Birthday"], answer:0 },
    { question:"Which of the following is a common social-engineering technique?", options:["Pretexting","Port scanning","Ping flooding","Hashing"], answer:0 },
    { question:"What tool captures network packets?", options:["Wireshark","Visual Studio","VLC","Paint"], answer:0 },
    { question:"Which is the most secure encryption algorithm?", options:["AES-256","MD5","DES","ROT13"], answer:0 },
    { question:"The CIA triad stands for‚Ä¶", options:["Confidentiality, Integrity, Availability","Cyber, Internet, Access","Central Intelligence Agency","Control, Invest, Analyze"], answer:0 },

    { question:"What is the full form of 'VPN'?", options:["Virtual Public Network","Virtual Private Network","Visual Processing Network","Volatile Private Network"], answer:1 },
    { question:"What is the main purpose of a VPN?", options:["To hide your IP address and encrypt your data","To speed up your internet connection","To access blocked content only","To bypass software updates"], answer:0 },
    { question:"What does the acronym 'SSL' stand for?", options:["Secure Sockets Layer","Socket Security Layer","Simple Secure Layer","Secure Software Layer"], answer:0 },
    { question:"Which of these is NOT an example of a phishing attempt?", options:["Email asking for login details with a suspicious link","Phone call asking for credit card details","A request from your bank asking for password updates","A request from a website offering a free trial"], answer:3 },
    { question:"Which of these best describes 'social engineering'?", options:["Tricking people into disclosing confidential information","Using software to track people's activities","Hacking into databases remotely","Using a secure network for communication"], answer:0 },
    { question:"What is 'two-factor authentication'?", options:["A second password for extra security","A method of using two devices for login","A system where you need both your password and something you know or have (like a phone)","A method of using a password and a fingerprint"], answer:2 },
    { question:"Which of these is an example of a ransomware attack?", options:["A program that encrypts your files and demands payment for decryption","A virus that slows down your computer","A phishing attempt","A Trojan horse that hides malicious software"], answer:0 },
    { question:"What is the function of a password manager?", options:["It remembers all your passwords securely","It generates strong passwords automatically","It encrypts your passwords","All of the above"], answer:3 },
    { question:"Which of these passwords is safest?", options:["12345","password123","R@1nB0w$!25X","qwerty"], answer:2 },

    { question:"What is the main purpose of HTTPS?", options:["To secure communications between the user and the website","To speed up website load time","To detect vulnerabilities in web servers","To store user information securely"], answer:0 },
    { question:"What is malware?", options:["Any malicious software","A file compression format","A software update tool","A firewall software"], answer:0 },
    { question:"What should you do if you lose your phone?", options:["Call your carrier to lock it","Change all your passwords immediately","Try to track it using a GPS app","All of the above"], answer:3 },
    { question:"What is the main function of a firewall?", options:["To block all internet traffic","To prevent unauthorized access to a network","To delete unnecessary files","To manage network traffic"], answer:1 },
    { question:"Which of these is a type of malware?", options:["Spyware","Antivirus","Firewall","Encryption software"], answer:0 },
    { question:"What is a keylogger?", options:["A device that records keystrokes","A type of malware","A tool to improve typing speed","A password manager"], answer:0 },
    { question:"Why should you be cautious of public Wi-Fi?", options:["It‚Äôs often not encrypted, making it vulnerable to attacks","It‚Äôs slower than private Wi-Fi","It‚Äôs always free","It can improve your device‚Äôs security"], answer:0 },
    { question:"What is the difference between HTTP and HTTPS?", options:["HTTP is slower","HTTPS is a more secure version of HTTP","HTTP is for government sites only","There‚Äôs no difference"], answer:1 },
    { question:"What is a Trojan horse?", options:["A legitimate-looking program that contains malicious software","A security tool used to detect malware","A type of hardware used to protect against hacking","A safe online storage service"], answer:0 },
    { question:"What does ‚Äòtwo-factor authentication‚Äô provide?", options:["Two layers of password protection","An extra layer of security using something you know and something you have","Two passwords for each account","Automatic password generation"], answer:1 },
    { question:"What should you do if you receive a suspicious email?", options:["Open all links and attachments to investigate","Delete it and report it to IT security","Forward it to everyone in your contact list","Save it for later reading"], answer:1 }
];
<script>
  const state = {
    quizData: selectedQuestions,  // Using the selected questions
    currentQuestion: 0,
    score: 0,
    totalTime: 0,
    playCount: parseInt(localStorage.getItem("playCount") || "0"),
    topCount: parseInt(localStorage.getItem("topCount") || "0"),
    highScore: parseInt(localStorage.getItem("cyberQuizHighScore") || "0")
  };

  // Function to load a question
  function loadQuestion() {
    const q = state.quizData[state.currentQuestion];
    if (!q) { showResults(); return; }

    document.getElementById("question").textContent = q.question;
    const optContainer = document.getElementById("options");
    optContainer.innerHTML = "";

    q.options.forEach((opt, i) => {
      const btn = document.createElement("button");
      btn.textContent = opt;
      btn.className = "option-btn";
      btn.onclick = () => checkAnswer(i);
      optContainer.appendChild(btn);
    });

    document.getElementById("feedback-area").textContent = "";
    document.getElementById("next-btn").style.display = "none";
  }

  // Function to check the selected answer
  function checkAnswer(selectedIndex) {
    const q = state.quizData[state.currentQuestion];
    const timeTaken = (Date.now() - state.startTime) / 1000;
    state.totalTime += timeTaken;

    const feedback = document.getElementById("feedback-area");
    const buttons = document.querySelectorAll("#options button");

    buttons.forEach((b, i) => {
      b.disabled = true;
      if (i === q.answer) b.classList.add("correct");
      if (i === selectedIndex && i !== q.answer) b.classList.add("wrong");
    });

    if (selectedIndex === q.answer) {
      feedback.textContent = "‚úÖ Correct!";
      state.score++;
      playSound(correctSound);  // Play correct sound
    } else {
      feedback.textContent = `‚ùå Wrong! Correct answer: ${q.options[q.answer]}`;
      playSound(incorrectSound);  // Play incorrect sound
    }

    document.getElementById("next-btn").style.display = "inline-block";
  }

  // Move to the next question or show results if it's the last question
  document.getElementById("next-btn").onclick = function () {
    state.currentQuestion++;
    if (state.currentQuestion < state.quizData.length) {
      loadQuestion();
    } else {
      showResults();
    }
  };

  // Show results when the quiz is over
  function showResults() {
    document.getElementById("quiz-container").classList.add("hidden");
    document.getElementById("results-container").classList.remove("hidden");

    const total = state.quizData.length;
    const avgTime = total > 0 ? (state.totalTime / total).toFixed(1) : 0;
    document.getElementById("score-display-area").innerHTML = `
      <h2>Score: ${state.score} / ${total}</h2>
      <p>Average time per question: ${avgTime}s</p>
    `;

    playSound(quizFinishSound);  // Play quiz finish sound

    state.playCount++;
    localStorage.setItem("playCount", state.playCount);
    updateAchievements(avgTime);
    updateHighScore();
  }

  // Update achievements based on performance
  function updateAchievements(avgTime) {
    const achievements = [
      { id: "perfect", title: "Perfectionist", description: "Got every question right!", condition: (score, total) => score === total },
      { id: "fastThinker", title: "Fast Thinker", description: "Answered all questions quickly!", condition: (score, total, avgTime) => avgTime < 5 },
      { id: "persistent", title: "Persistent Player", description: "Played multiple times!", condition: (_, __, ___, playCount) => playCount >= 5 },
      { id: "cyberGuru", title: "Cyber Guru", description: "Achieved top score multiple times!", condition: (_, __, ___, ____, topCount) => topCount >= 3 }
    ];

    const achieved = [];
    achievements.forEach(a => {
      if (a.condition(state.score, state.quizData.length, avgTime, state.playCount, state.topCount)) achieved.push(a);
    });

    const area = document.getElementById("achievements-earned");
    if (achieved.length > 0) {
      area.innerHTML = "<h3>üéñÔ∏è Achievements Unlocked:</h3>" + achieved.map(a => `<p>${a.title} - ${a.description}</p>`).join("");
    } else {
      area.innerHTML = "<p>No new achievements this time.</p>";
    }
  }

  // Update high score if needed
  function updateHighScore() {
    const prevHigh = parseInt(localStorage.getItem("cyberQuizHighScore") || "0");
    if (state.score > prevHigh) {
      localStorage.setItem("cyberQuizHighScore", state.score);
      localStorage.setItem("topCount", state.topCount + 1);
      document.getElementById("high-score-area").innerHTML = `<p>ü•á New High Score: ${state.score}</p>`;
    } else {
      document.getElementById("high-score-area").innerHTML = `<p>High Score: ${prevHigh}</p>`;
    }
  }

  // Save score to leaderboard
  function saveScoreToLeaderboard(name) {
    const lb = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    lb.push({ name, score: state.score, date: new Date().toISOString() });
    lb.sort((a, b) => b.score - a.score);
    if (lb.length > 10) lb.length = 10;
    localStorage.setItem("leaderboard", JSON.stringify(lb));
    renderLeaderboard();
  }

  // Render leaderboard on page load
  document.addEventListener("DOMContentLoaded", () => {
    renderLeaderboard();
  });
</script>
<script>
  // Sound effect for correct answer
  const correctSound = new Audio('https://files.catbox.moe/vxltiz.mp3');
  // Sound effect for incorrect answer
  const incorrectSound = new Audio('https://files.catbox.moe/8uswny.mp3');
  // Sound effect for quiz finish (You can replace this with your own finish sound URL)
  const quizFinishSound = new Audio('path_to_quiz_finish_sound.mp3');  // Replace with your finish sound URL

  // Function to play a sound
  function playSound(sound) {
      sound.play();
  }

  // Function to load a question
  function loadQuestion() {
    const q = state.quizData[state.currentQuestion];
    if (!q) { 
      showResults();
      return;
    }

    document.getElementById("question").textContent = q.question;
    const optContainer = document.getElementById("options");
    optContainer.innerHTML = "";

    q.options.forEach((opt, i) => {
      const btn = document.createElement("button");
      btn.textContent = opt;
      btn.className = "option-btn";
      btn.onclick = () => checkAnswer(i);
      optContainer.appendChild(btn);
    });

    document.getElementById("feedback-area").textContent = "";
    document.getElementById("next-btn").style.display = "none";
  }

  // Function to check the selected answer
  function checkAnswer(selectedIndex) {
    const q = state.quizData[state.currentQuestion];
    const timeTaken = (Date.now() - state.startTime) / 1000;
    state.totalTime += timeTaken;

    const feedback = document.getElementById("feedback-area");
    const buttons = document.querySelectorAll("#options button");

    buttons.forEach((b, i) => {
      b.disabled = true;
      if (i === q.answer) b.classList.add("correct");
      if (i === selectedIndex && i !== q.answer) b.classList.add("wrong");
    });

    if (selectedIndex === q.answer) {
      feedback.textContent = "‚úÖ Correct!";
      state.score++;
      playSound(correctSound);  // Play correct sound
    } else {
      feedback.textContent = `‚ùå Wrong! Correct answer: ${q.options[q.answer]}`;
      playSound(incorrectSound);  // Play incorrect sound
    }

    document.getElementById("next-btn").style.display = "inline-block";
  }

  // Move to the next question or show results if it's the last question
  document.getElementById("next-btn").onclick = function () {
    state.currentQuestion++;
    if (state.currentQuestion < state.quizData.length) {
      loadQuestion();
    } else {
      showResults();
    }
  };

  // Show results when the quiz is over
  function showResults() {
    document.getElementById("quiz-container").classList.add("hidden");
    document.getElementById("results-container").classList.remove("hidden");

    const total = state.quizData.length;
    const avgTime = total > 0 ? (state.totalTime / total).toFixed(1) : 0;
    document.getElementById("score-display-area").innerHTML = `
      <h2>Score: ${state.score} / ${total}</h2>
      <p>Average time per question: ${avgTime}s</p>
    `;

    playSound(quizFinishSound);  // Play quiz finish sound

    state.playCount++;
    localStorage.setItem("playCount", state.playCount);
    updateAchievements(avgTime);
    updateHighScore();
  }

  // Update achievements based on performance
  function updateAchievements(avgTime) {
    const achievements = [
      { id: "perfect", title: "Perfectionist", description: "Got every question right!", condition: (score, total) => score === total },
      { id: "fastThinker", title: "Fast Thinker", description: "Answered all questions quickly!", condition: (score, total, avgTime) => avgTime < 5 },
      { id: "persistent", title: "Persistent Player", description: "Played multiple times!", condition: (_, __, ___, playCount) => playCount >= 5 },
      { id: "cyberGuru", title: "Cyber Guru", description: "Achieved top score multiple times!", condition: (_, __, ___, ____, topCount) => topCount >= 3 }
    ];

    const achieved = [];
    achievements.forEach(a => {
      if (a.condition(state.score, state.quizData.length, avgTime, state.playCount, state.topCount)) achieved.push(a);
    });

    const area = document.getElementById("achievements-earned");
    if (achieved.length > 0) {
      area.innerHTML = "<h3>üéñÔ∏è Achievements Unlocked:</h3>" + achieved.map(a => `<p>${a.title} - ${a.description}</p>`).join("");
    } else {
      area.innerHTML = "<p>No new achievements this time.</p>";
    }
  }

  // Update high score if needed
  function updateHighScore() {
    const prevHigh = parseInt(localStorage.getItem("cyberQuizHighScore") || "0");
    if (state.score > prevHigh) {
      localStorage.setItem("cyberQuizHighScore", state.score);
      localStorage.setItem("topCount", state.topCount + 1);
      document.getElementById("high-score-area").innerHTML = `<p>ü•á New High Score: ${state.score}</p>`;
    } else {
      document.getElementById("high-score-area").innerHTML = `<p>High Score: ${prevHigh}</p>`;
    }
  }

  // Save score to leaderboard
  function saveScoreToLeaderboard(name) {
    const lb = JSON.parse(localStorage.getItem("leaderboard") || "[]");
    lb.push({ name, score: state.score, date: new Date().toISOString() });
    lb.sort((a, b) => b.score - a.score);
    if (lb.length > 10) lb.length = 10;
    localStorage.setItem("leaderboard", JSON.stringify(lb));
    renderLeaderboard();
  }

  // Render leaderboard on page load
  document.addEventListener("DOMContentLoaded", () => {
    renderLeaderboard();
  });
</script>
<script>
  // Sound effect for correct answer
  const correctSound = new Audio('https://files.catbox.moe/vxltiz.mp3');
  // Sound effect for incorrect answer
  const incorrectSound = new Audio('https://files.catbox.moe/8uswny.mp3');
  // Sound effect for quiz finish
  const quizFinishSound = new Audio('path_to_quiz_finish_sound.mp3');  // Replace with your finish sound URL

  // Function to play a sound
  function playSound(sound) {
      sound.play();
  }

  // Function to apply settings
  const settings = {
    background: localStorage.getItem("setting_background") === "true",
    contrast: localStorage.getItem("setting_contrast") === "true",
    largeText: localStorage.getItem("setting_largeText") === "true",
    reduceMotion: localStorage.getItem("setting_reduceMotion") === "true",
    theme: localStorage.getItem("setting_theme") || "dark"
  };

  function applySettings() {
    document.body.classList.toggle("minimal-bg", !settings.background);
    document.body.classList.toggle("high-contrast", settings.contrast);
    document.body.classList.toggle("large-text", settings.largeText);
    document.body.classList.toggle("reduce-motion", settings.reduceMotion);
    document.body.classList.toggle("light-theme", settings.theme === "light");

    document.getElementById("bg-toggle").checked = settings.background;
    document.getElementById("contrast-toggle").checked = settings.contrast;
    document.getElementById("large-toggle").checked = settings.largeText;
    document.getElementById("motion-toggle").checked = settings.reduceMotion;
    document.getElementById("theme-select").value = settings.theme;
  }

  function updateSetting(key, value) {
    settings[key] = value;
    localStorage.setItem(`setting_${key}`, value);
    applySettings();
  }

  document.getElementById("bg-toggle").onchange = e => updateSetting("background", e.target.checked);
  document.getElementById("contrast-toggle").onchange = e => updateSetting("contrast", e.target.checked);
  document.getElementById("large-toggle").onchange = e => updateSetting("largeText", e.target.checked);
  document.getElementById("motion-toggle").onchange = e => updateSetting("reduceMotion", e.target.checked);
  document.getElementById("theme-select").onchange = e => updateSetting("theme", e.target.value);

  // Admin reset functionality with /api/check-password.js
  async function resetData(type) {
    const pass = prompt("Enter admin password:");
    if (!pass) return alert("Cancelled.");

    try {
      const res = await fetch("/api/check-password", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ password: pass })
      });
      const data = await res.json();
      if (!data.success) return alert("‚ùå Invalid password!");

      if (type === "leaderboard") localStorage.removeItem("leaderboard");
      if (type === "new-player") {
        localStorage.removeItem("playCount");
        localStorage.removeItem("cyberQuizHighScore");
      }
      if (type === "master") {
        localStorage.clear();
      }

      alert(`‚úÖ ${type.replace("-", " ").toUpperCase()} reset successful.`);
      renderLeaderboard();
    } catch (err) {
      alert("Error connecting to server.");
      console.error(err);
    }
  }

  // Settings Modal Control
  function openModal() {
    document.getElementById("modal-overlay").style.display = "block";
    applySettings();
  }

  function closeModal() {
    document.getElementById("modal-overlay").style.display = "none";
  }

  document.getElementById("settings-btn").onclick = openModal;
  document.addEventListener("DOMContentLoaded", () => {
    renderLeaderboard();
    applySettings();
  });

  // Starfield Background Animation
  const canvas = document.getElementById("starfield-canvas");
  const ctx = canvas.getContext("2d");
  let stars = [];

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    generateStars();
  }

  function generateStars() {
    const count = 100;
    stars = [];
    for (let i = 0; i < count; i++) {
      stars.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        radius: Math.random() * 1.5,
        speed: 0.1 + Math.random() * 0.3
      });
    }
  }

  function animateStars() {
    if (document.body.classList.contains("minimal-bg")) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      return requestAnimationFrame(animateStars);
    }
    ctx.fillStyle = "rgba(0,0,0,0.3)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#fff";

    stars.forEach(s => {
      s.y += s.speed;
      if (s.y > canvas.height) s.y = 0;
      ctx.beginPath();
      ctx.arc(s.x, s.y, s.radius, 0, Math.PI * 2);
      ctx.fill();
    });

    requestAnimationFrame(animateStars);
  }

  window.addEventListener("resize", resizeCanvas);
  resizeCanvas();
  animateStars();
</script>
  <!-- Closing the modal and body content -->
  </div> <!-- End of #modal-content -->
  </div> <!-- End of #modal-overlay -->

  </body>
</html>
